# QV Data Analysis Tool Usage Guide

## 基本的な使い方

```bash
python qv_data_analysis_ver6.py <input_file> [options]
```

## 必須引数
- `input_file`: 入力CSVファイルのパス

## オプション引数

### ピッチ関連
- `--specified_pitch <value>`: ピッチ値の指定
  - 単一の値: "0.5" (X,Y両方に同じ値)
  - X,Y個別指定: "0.5,0.6"
  - 統計値: "mean", "median", "mean_x,median_y" など
- `--target_pitch_x <value>`: 目標X方向ピッチ
- `--target_pitch_y <value>`: 目標Y方向ピッチ
- `--exclude_pitch_rows <int>`: ピッチ計算から除外する外周行数 (デフォルト: 2)

### データ処理
- `--delete_rows <int>`: 外周から削除する行数 (デフォルト: 0)
- `--x_divisions <int>`: X方向の分割数 (デフォルト: 10)
- `--y_divisions <int>`: Y方向の分割数 (デフォルト: 10)
- `--hole_type {old,new,none}`: ホールタイプの指定 (デフォルト: old)
- `--interpolate_all`: 全ポイントを補間する
- `-p`, `--pkl`: 補正モデルをpklファイルとして保存

## 出力ファイル

プログラムは以下のファイルを生成します：

1. Excelファイル (`<input_name>.out.xlsx`)
   - Raw Data: 生データ
   - 各種ピボットテーブル
   - パラメータシート
   - プロット用シート

2. プロット画像
   - ベクトルプロット
   - スキャッタープロット
   - 補正プロット
   - ピッチヒストグラム
   - 新ピッチベクトルプロット
   - 新ピッチスキャッタープロット

3. 補正モデル (`<input_name>.out.pkl`)
   - `--pkl`オプション指定時のみ生成

## 使用例

1. 基本的な分析:
```bash
python qv_data_analysis_ver6.py input.csv
```

2. カスタムピッチ指定:
```bash
python qv_data_analysis_ver6.py input.csv --specified_pitch 0.5,0.6
```

3. 外周データの除外と補正モデル保存:
```bash
python qv_data_analysis_ver6.py input.csv --delete_rows 2 --pkl
```

4. 詳細な補間設定:
```bash
python qv_data_analysis_ver6.py input.csv --x_divisions 15 --y_divisions 15 --interpolate_all
```

## データ分析機能

1. ピッチ計算
   - X方向・Y方向のピッチを計算
   - 統計値（平均、中央値）の算出
   - ヒストグラム生成

2. 位置ずれ分析
   - X方向・Y方向のずれ量計算
   - 位置ずれベクトル表示
   - スキャッタープロットによる分布可視化

3. 補正モデル生成
   - RBF補間による補正モデル作成
   - 補正効果の可視化
   - モデルの保存と再利用

## 注意事項

- 入力CSVファイルは shift-jis エンコーディングである必要があります
- データ形式は指定されたフォーマットに従う必要があります
- 外周行の除外数は適切に設定する必要があります
- ピッチ指定時は実測値との整合性を確認してください
