

## サンプルCSVファイル構造
```csv
X,Y,直径
10.0,20.0,5.0
15.0,20.0,5.0
20.0,20.0,5.0
10.0,25.0,5.0
15.0,25.0,6.0
20.0,25.0,5.0
10.0,30.0,5.0
15.0,30.0,5.0
20.0,30.0,5.0
```

## 1. 配列変数とサイズ関連

| 変数名 | 型 | 値 | 説明 |
|--------|-----|-----|------|
| ArrSizeCol | Integer | 3 | 列数 (X,Y,直径) |
| ArrSizeRow | Integer | 9 | データの行数 |
| ColLabel() | String配列 | ["X", "Y", "直径"] | 列の名前 |

## 2. HolesArr の内容 (9行×3列の2次元配列)

| 行 | 列0(X) | 列1(Y) | 列2(直径) |
|----|---------|---------|------------|
| 0 | 10.0 | 20.0 | 5.0 |
| 1 | 15.0 | 20.0 | 5.0 |
| 2 | 20.0 | 20.0 | 5.0 |
| 3 | 10.0 | 25.0 | 5.0 |
| 4 | 15.0 | 25.0 | 6.0 |
| 5 | 20.0 | 25.0 | 5.0 |
| 6 | 10.0 | 30.0 | 5.0 |
| 7 | 15.0 | 30.0 | 5.0 |
| 8 | 20.0 | 30.0 | 5.0 |

## 3. 検索結果の変数

| 変数名 | 型 | 値 | 説明 |
|--------|-----|-----|------|
| SearchMax1 | Double | 20.0 | X座標の最大値 |
| SearchMin1 | Double | 10.0 | X座標の最小値 |
| SearchMax2 | Double | 30.0 | Y座標の最大値 |
| SearchMin2 | Double | 20.0 | Y座標の最小値 |

## 4. グリッドサイズ関連

| 変数名 | 型 | 値 | 説明 |
|--------|-----|-----|------|
| PinGridWidth | Double | 10.0 | グリッドの幅 (Max1 - Min1) |
| PinGridHeight | Double | 10.0 | グリッドの高さ (Max2 - Min2) |
| X_NO1 | Double | 10.0 | 開始X座標 (SearchMin1) |
| Y_NO1 | Double | 30.0 | 開始Y座標 (SearchMax2) |

## 5. フラグ変数

| 変数名 | 型 | 値 | 説明 |
|--------|-----|-----|------|
| CsvWidthBool | Boolean | True | 直径が異なる穴があるか（この例ではTrue、中央が6.0で他が5.0のため） |
| Initial_CR_Bool | Integer | 1 | 初期値設定フラグ |

## 変数の主な用途
1. データの格納（HolesArr）
2. 範囲の把握（Search系の変数）
3. グリッドサイズの計算（PinGrid系の変数）
4. 直径の一貫性チェック（CsvWidthBool）

## 詳細な処理の流れ

### 1. ファイルのオープンと初期設定 (1-4行目)
```vb
DataFileName = "5X-117-242-01-B.csv"
DataFile = FreeFile
Open DataFileName for Input As # DataFile
```

### 2. 列ラベルの読み取り (5-15行目)
```vb
Line Input # DataFile, buffer '列ラベルColLabel()の格納
i = 0
PreLbl = "仮"
Do Until PreLbl = ""
   i=i+1
   PreLbl = GetField(buffer, i, ",")
loop
ArrSizeCol = i-1
ReDim ColLabel(ArrSizeCol-1)
For i = 0 to ArrSizeCol - 1
   ColLabel(i) = GetField(buffer, i+1, ",")
Next i
```

### 3. データ行数のカウント (16-23行目)
```vb
Seek # DataFile, 1
i = 0
Do Until EOF(DataFile)
   Line Input # DataFile, buffer
   i = i + 1
Loop
ArrSizeRow = i - 1
ReDim HolesArr(ArrSizeRow-1, ArrSizeCol-1)
```

### 4. データの配列への格納 (24-33行目)
```vb
Seek # DataFile, 1
Line Input # DataFile, buffer 'ラベル行の空読込
For i = 0 to ArrSizeRow -1
   Line Input # DataFile, buffer
   for k = 0 to ArrSizeCol-1
      HolesArr(i, k) = Val(GetField(buffer, k+1, ","))
   Next k
Next i
Close # DataFile
```

### 5. 座標範囲の計算 (34-52行目)
```vb
SearchMax1 = HolesArr(0, 0)
SearchMin1 = HolesArr(0, 0)
SearchMax2 = HolesArr(0, 1)
SearchMin2 = HolesArr(0, 1)
For i = 0 to ArrSizeRow - 1
   If HolesArr(i, 0) > SearchMax1 Then
      SearchMax1 = HolesArr(i, 0)
   end if
   If HolesArr(i, 0) < SearchMin1 Then
      SearchMin1 = HolesArr(i, 0)
   end if
   If HolesArr(i, 1) > SearchMax2 Then
      SearchMax2 = HolesArr(i, 1)
   end if
   If HolesArr(i, 1) < SearchMin2 Then
      SearchMin2 = HolesArr(i, 1)
   end if
Next i
```

### 6. グリッドサイズの計算 (53-56行目)
```vb
PinGridWidth = SearchMax1 - SearchMin1
PinGridHeight = SearchMax2 - SearchMin2
X_NO1 = SearchMin1
Y_NO1 = SearchMax2
```

### 7. 列数チェックと直径の一貫性確認 (57-73行目)
```vb
Initial_CR_Bool = 1
select case ArrSizeCol
   case 3 '座標,Y座標,直径
      For i = 1 to ArrSizeRow - 2
         If HolesArr(i, 2) <> HolesArr(i + 1, 2) Then
            CsvWidthBool = True
         End if
      Next i
   case Is >3
      MsgBox "CSVが4列以上ないですか？"
      Exit sub
   case Is < 2
      MsgBox "CSVが2列未満ではないですか？"
      Exit sub
end select
```

### 処理結果
- 2列または3列のCSVを読み込み
- 穴の座標データを2次元配列に格納
- 座標の範囲を計算
- グリッドサイズを決定
- 直径が均一かどうかをチェック（3列の場合）
